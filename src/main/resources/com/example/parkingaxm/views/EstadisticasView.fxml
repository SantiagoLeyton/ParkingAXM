<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.chart.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>

<StackPane xmlns="http://javafx.com/javafx"
           xmlns:fx="http://javafx.com/fxml"
           fx:controller="com.example.parkingaxm.controllers.EstadisticasController"
           stylesheets="@../css/estilos.css"
           styleClass="login-background">

    <!-- Fondo con destellos -->
    <Pane styleClass="background-effects"/>

    <!-- Contenedor principal -->
    <VBox alignment="TOP_CENTER" spacing="25" maxWidth="1300">

        <!-- Tarjeta tipo Glass -->
        <VBox alignment="TOP_CENTER" spacing="20" styleClass="glass-card" maxWidth="1300">

            <!-- ============================
                 BARRA DE FILTROS
            ============================ -->
            <HBox spacing="15" alignment="CENTER">
                <Label text="Desde:"/>
                <DatePicker fx:id="dpDesde"/>

                <Label text="Hasta:"/>
                <DatePicker fx:id="dpHasta"/>

                <Label text="Tipo:"/>
                <ComboBox fx:id="cbTipo"/>

                <Button text="Aplicar filtros"
                        onAction="#onAplicarFiltros"
                        styleClass="login-button"/>

                <Button text="Exportar PDF"
                        onAction="#onExportarPdf"
                        styleClass="login-button"/>

                <Button text="Volver al menú"
                        onAction="#volverAlMenu"
                        style="
                            -fx-background-color: rgba(255,255,255,0.2);
                            -fx-text-fill: white;
                            -fx-padding: 10 20;
                            -fx-background-radius: 12;
                            -fx-border-color: rgba(255,255,255,0.3);
                            -fx-border-radius: 12;
                        "/>
            </HBox>

            <!-- ============================
                 TABPANE GLASS
            ============================ -->
            <TabPane fx:id="tabPane" styleClass="glass-tabs">

                <!-- ===================================================
                     TAB 1: RESUMEN
                =================================================== -->
                <Tab text="Resumen">
                    <ScrollPane fitToWidth="true" fitToHeight="true">
                        <VBox alignment="CENTER" spacing="25" styleClass="estadisticas-content">
                            <padding>
                                <Insets top="20" bottom="20" left="20" right="20"/>
                            </padding>

                            <!-- Título -->
                            <Label text="Resumen de estadísticas"
                                   styleClass="estadisticas-title"/>

                            <!-- Totales -->
                            <HBox alignment="CENTER" spacing="50">
                                <VBox alignment="CENTER">
                                    <Label text="Total Vehículos"/>
                                    <Label fx:id="lblTotal" styleClass="estadisticas-number"/>
                                </VBox>

                                <VBox alignment="CENTER">
                                    <Label text="Carros"/>
                                    <Label fx:id="lblCarros" styleClass="estadisticas-number"/>
                                </VBox>

                                <VBox alignment="CENTER">
                                    <Label text="Motos"/>
                                    <Label fx:id="lblMotos" styleClass="estadisticas-number"/>
                                </VBox>
                            </HBox>

                            <Separator styleClass="estadisticas-separator"/>

                            <!-- GRID DETALLES -->
                            <GridPane hgap="20" vgap="10" styleClass="estadisticas-grid">

                                <columnConstraints>
                                    <ColumnConstraints halignment="RIGHT"/>
                                    <ColumnConstraints halignment="LEFT"/>
                                </columnConstraints>

                                <Label text="Vehículos hoy:" GridPane.rowIndex="0"/>
                                <Label fx:id="lblHoy" GridPane.rowIndex="0" GridPane.columnIndex="1"/>

                                <Label text="Vehículos semana:" GridPane.rowIndex="1"/>
                                <Label fx:id="lblSemana" GridPane.rowIndex="1" GridPane.columnIndex="1"/>

                                <Label text="Vehículos mes:" GridPane.rowIndex="2"/>
                                <Label fx:id="lblMes" GridPane.rowIndex="2" GridPane.columnIndex="1"/>

                                <Label text="Dinero hoy:" GridPane.rowIndex="3"/>
                                <Label fx:id="lblDineroHoy" GridPane.rowIndex="3" GridPane.columnIndex="1"/>

                                <Label text="Dinero semana:" GridPane.rowIndex="4"/>
                                <Label fx:id="lblDineroSemana" GridPane.rowIndex="4" GridPane.columnIndex="1"/>

                                <Label text="Dinero mes:" GridPane.rowIndex="5"/>
                                <Label fx:id="lblDineroMes" GridPane.rowIndex="5" GridPane.columnIndex="1"/>

                                <Label text="Dinero total:" GridPane.rowIndex="6"/>
                                <Label fx:id="lblDineroTotal" GridPane.rowIndex="6" GridPane.columnIndex="1"/>

                                <Label text="Permanencia promedio:" GridPane.rowIndex="7"/>
                                <Label fx:id="lblPermanenciaProm" GridPane.rowIndex="7" GridPane.columnIndex="1"/>

                                <Label text="Permanencia máxima:" GridPane.rowIndex="8"/>
                                <Label fx:id="lblPermanenciaMax" GridPane.rowIndex="8" GridPane.columnIndex="1"/>
                            </GridPane>

                        </VBox>
                    </ScrollPane>
                </Tab>

                <!-- ===================================================
                     TAB 2: GRÁFICAS
                =================================================== -->
                <Tab text="Gráficas">
                    <ScrollPane fitToWidth="true" fitToHeight="true">
                        <VBox spacing="20" alignment="TOP_CENTER" style="-fx-background-color: white;">
                            <padding>
                                <Insets top="20" bottom="20" left="20" right="20"/>
                            </padding>

                            <HBox spacing="20" alignment="CENTER" style="-fx-background-color: white;">
                                <PieChart fx:id="pieTipos"/>

                                <BarChart fx:id="barVehiculosDia" style="-fx-background-color: white;">
                                    <xAxis>
                                        <CategoryAxis label="Fecha"/>
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis label="Cantidad"/>
                                    </yAxis>
                                </BarChart>
                            </HBox>

                            <BarChart fx:id="barDineroDia">
                                <xAxis>
                                    <CategoryAxis label="Fecha"/>
                                </xAxis>
                                <yAxis>
                                    <NumberAxis label="Recaudo"/>
                                </yAxis>
                            </BarChart>
                        </VBox>
                    </ScrollPane>
                </Tab>

                <!-- ===================================================
                     TAB 3: HEATMAP
                =================================================== -->
                <Tab text="Mapa de calor">
                    <ScrollPane fitToWidth="true" fitToHeight="true"
                                style="-fx-background: white; -fx-background-color: white;">
                        <StackPane alignment="CENTER" style="-fx-background-color: white;">
                            <GridPane fx:id="gridHeatmap"
                                      hgap="4" vgap="4"
                                      style="-fx-padding: 20; -fx-background-color: white;" />
                        </StackPane>
                    </ScrollPane>
                </Tab>
            </TabPane>
        </VBox>
    </VBox>

</StackPane>
